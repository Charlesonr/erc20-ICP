import * as C from "@effect/io/Cause";
import { Signal } from "../Source.js";
import * as Runner from "./_internal/effectRunner.js";
export const repeatEffectOption = (fa) => (r) => (_, sink) => {
    const runner = Runner.make(r, (cause) => {
        runner.abort();
        if (cause._tag == "Fail") {
            sink(Signal.END, cause.error._tag === "Some" ? C.fail(cause.error.value) : undefined);
        }
        else {
            sink(Signal.END, cause);
        }
    }, 1);
    sink(Signal.START, (signal) => {
        if (signal === Signal.DATA) {
            runner.runEffect(fa, (a) => sink(Signal.DATA, a));
        }
        else if (signal === Signal.END) {
            runner.abort();
        }
    });
};
//# sourceMappingURL=repeatEffectOption.js.map