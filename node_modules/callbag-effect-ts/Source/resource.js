import * as CB from "strict-callbag-basics";
import * as O from "@fp-ts/data/Option";
import { pipe } from "callbag-effect-ts/Source";
export const resource = (initial, project, cleanup) => (r) => CB.resource(initial, (acc, index) => {
    const source = project(acc, index);
    return CB.pipe(source(r), CB.map(([acc, source]) => [
        pipe(acc, O.match(() => CB.NONE, (a) => a)),
        source(r),
    ]));
}, cleanup);
//# sourceMappingURL=resource.js.map