import * as T from "@effect/io/Effect";
import * as SC from "@effect/io/Schedule";
import { pipe } from "callbag-effect-ts/Source";
import { catchError } from "./catchError.js";
import { tap } from "./tap.js";
import { unwrap } from "./unwrap.js";
export const retry = (schedule) => (self) => pipe(SC.driver(schedule), T.map((driver) => {
    const loop = pipe(self, catchError((e) => pipe(driver.next(e), T.fold(() => loop, () => pipe(loop, tap(() => driver.reset()))), unwrap)));
    return loop;
}), unwrap);
//# sourceMappingURL=retry.js.map