import * as LB from "./_internal/lb.js";
export const mergeIdentical = (...sources) => (_, sink) => {
    const lb = LB.make((data) => sink(1, data), (err) => sink(2, err), () => {
        //
    });
    let started = false;
    sink(0, (signal) => {
        if (signal === 1) {
            if (started) {
                lb.pull();
            }
            else {
                started = true;
                sources.forEach((s) => lb.add(s));
                lb.end();
            }
        }
        else if (signal === 2) {
            lb.abort();
        }
    });
};
export const merge_ = (self, other) => mergeIdentical(self, other);
export const merge = (other) => (self) => merge_(self, other);
