import { createPipe } from "./createPipe.js";
export const toArray = (self) => (_, sink) => {
    let array = [];
    createPipe(self, sink, {
        onStart(s) {
            s.pull();
        },
        onRequest() {
            //
        },
        onData(s, data) {
            array.push(data);
            s.pull();
        },
        onEnd(err) {
            if (err) {
                array = [];
                sink(2, err);
            }
            else {
                sink(1, array);
                sink(2, undefined);
            }
        },
        onAbort() {
            array = [];
        },
    });
};
