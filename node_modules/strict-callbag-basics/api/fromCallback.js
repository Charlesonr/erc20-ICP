export const fromCallback = (f) => (_, sink) => {
    let running = false;
    let aborted = false;
    const cb = (err, data) => {
        if (aborted)
            return;
        if (err) {
            sink(2, err);
        }
        else {
            if (data) {
                sink(1, data);
            }
            sink(2, undefined);
        }
    };
    sink(0, (signal) => {
        if (signal === 1) {
            if (running)
                return;
            running = true;
            f(cb);
        }
        else if (signal === 2) {
            aborted = true;
        }
    });
};
